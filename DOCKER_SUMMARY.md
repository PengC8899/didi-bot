# Docker éƒ¨ç½²æ€»ç»“

## åˆ›å»ºçš„æ–‡ä»¶åˆ—è¡¨

### æ ¸å¿ƒéƒ¨ç½²æ–‡ä»¶
- `Dockerfile` - æœºå™¨äººåº”ç”¨çš„Dockeré•œåƒå®šä¹‰
- `docker-compose.yaml` - å¼€å‘ç¯å¢ƒé…ç½®
- `docker-compose.prod.yaml` - ç”Ÿäº§ç¯å¢ƒé…ç½®
- `.dockerignore` - Dockeræ„å»ºå¿½ç•¥æ–‡ä»¶
- `healthcheck.py` - å®¹å™¨å¥åº·æ£€æŸ¥è„šæœ¬

### éƒ¨ç½²ç®¡ç†
- `deploy.sh` - ä¸€é”®éƒ¨ç½²ç®¡ç†è„šæœ¬
- `DOCKER_DEPLOY.md` - è¯¦ç»†éƒ¨ç½²æ–‡æ¡£

### ç›‘æ§æœåŠ¡
- `docker-compose.monitoring.yaml` - ç›‘æ§æœåŠ¡é…ç½®
- `monitoring/prometheus.yml` - Prometheusé…ç½®

### æ–‡æ¡£æ›´æ–°
- `README.md` - æ·»åŠ äº†Dockeréƒ¨ç½²è¯´æ˜
- `DOCKER_SUMMARY.md` - æœ¬æ€»ç»“æ–‡æ¡£

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   orderbot      â”‚
â”‚  (Python App)   â”‚
â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   SQLite    â”‚ â”‚
â”‚ â”‚  Database   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç”Ÿäº§ç¯å¢ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   orderbot      â”‚    â”‚   Monitoring    â”‚
â”‚  (Python App)   â”‚    â”‚                 â”‚
â”‚                 â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”‚ Prometheus  â”‚ â”‚
â”‚ â”‚   SQLite    â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚  Database   â”‚ â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â”‚   Grafana   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                       â”‚ â”‚  cAdvisor   â”‚ â”‚
                       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿéƒ¨ç½²æŒ‡å—

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# ç¡®ä¿Dockerå·²å®‰è£…å¹¶è¿è¡Œ
docker --version
docker-compose --version

# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
# git clone <repository-url>
cd DDGL_bot

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vim .env  # ç¼–è¾‘é…ç½®
```

### 2. å¼€å‘ç¯å¢ƒéƒ¨ç½²
```bash
# ä¸€é”®å¯åŠ¨
./deploy.sh start --dev

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs --dev

# æŸ¥çœ‹çŠ¶æ€
./deploy.sh status --dev
```

### 3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# ä¸€é”®å¯åŠ¨
./deploy.sh start --prod

# å¯åŠ¨ç›‘æ§ï¼ˆå¯é€‰ï¼‰
./deploy.sh monitor

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs --prod
```

## å…³é”®ç‰¹æ€§

### å®‰å…¨æ€§
- érootç”¨æˆ·è¿è¡Œ
- ç½‘ç»œéš”ç¦»ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- èµ„æºé™åˆ¶
- å¥åº·æ£€æŸ¥

### å¯ç»´æŠ¤æ€§
- ç»Ÿä¸€çš„éƒ¨ç½²è„šæœ¬
- ç¯å¢ƒå˜é‡é…ç½®
- æ—¥å¿—è½®è½¬
- æ•°æ®æŒä¹…åŒ–

### ç›‘æ§èƒ½åŠ›
- å®¹å™¨èµ„æºç›‘æ§
- åº”ç”¨å¥åº·æ£€æŸ¥
- ç³»ç»ŸæŒ‡æ ‡æ”¶é›†
- å¯è§†åŒ–é¢æ¿

## ç›®å½•ç»“æ„

```
DDGL_bot/
â”œâ”€â”€ Dockerfile                      # åº”ç”¨é•œåƒå®šä¹‰
â”œâ”€â”€ .dockerignore                   # Dockerå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ docker-compose.yaml             # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.prod.yaml        # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.monitoring.yaml  # ç›‘æ§æœåŠ¡é…ç½®
â”œâ”€â”€ deploy.sh                       # éƒ¨ç½²ç®¡ç†è„šæœ¬
â”œâ”€â”€ healthcheck.py                  # å¥åº·æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ monitoring/
â”‚   â””â”€â”€ prometheus.yml              # Prometheusé…ç½®
â”œâ”€â”€ data/                           # æ•°æ®ç›®å½•ï¼ˆæŒä¹…åŒ–ï¼‰
â”œâ”€â”€ images/                         # å›¾ç‰‡ç›®å½•ï¼ˆæŒä¹…åŒ–ï¼‰
â”œâ”€â”€ logs/                           # æ—¥å¿—ç›®å½•ï¼ˆæŒä¹…åŒ–ï¼‰
â”œâ”€â”€ DOCKER_DEPLOY.md               # è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ DOCKER_SUMMARY.md              # æœ¬æ€»ç»“æ–‡æ¡£
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜ï¼ˆå·²æ›´æ–°ï¼‰
```

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# å¼€å‘ç¯å¢ƒ
./deploy.sh start --dev     # å¯åŠ¨å¼€å‘ç¯å¢ƒ
./deploy.sh logs --dev      # æŸ¥çœ‹å¼€å‘ç¯å¢ƒæ—¥å¿—
./deploy.sh stop --dev      # åœæ­¢å¼€å‘ç¯å¢ƒ

# ç”Ÿäº§ç¯å¢ƒ
./deploy.sh start --prod    # å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
./deploy.sh logs --prod     # æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒæ—¥å¿—
./deploy.sh stop --prod     # åœæ­¢ç”Ÿäº§ç¯å¢ƒ

# ç›‘æ§æœåŠ¡
./deploy.sh monitor         # ç®¡ç†ç›‘æ§æœåŠ¡

# ç»´æŠ¤æ“ä½œ
./deploy.sh build           # é‡æ–°æ„å»ºé•œåƒ
./deploy.sh status          # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./deploy.sh clean           # æ¸…ç†æ‰€æœ‰èµ„æº
```

## ç«¯å£æ˜ å°„

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| Telegram Bot | - | é€šè¿‡Telegram APIé€šä¿¡ |
| Prometheus | 9090 | ç›‘æ§æ•°æ®æ”¶é›† |
| Grafana | 3000 | æ•°æ®å¯è§†åŒ–é¢æ¿ |
| cAdvisor | 8080 | å®¹å™¨ç›‘æ§ |
| Node Exporter | 9100 | ç³»ç»Ÿç›‘æ§ |

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **Dockerå®ˆæŠ¤è¿›ç¨‹æœªè¿è¡Œ**: å¯åŠ¨Docker Desktop
2. **ç«¯å£å†²çª**: æ£€æŸ¥ç«¯å£å ç”¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶
3. **æƒé™é—®é¢˜**: ç¡®ä¿deploy.shæœ‰æ‰§è¡Œæƒé™
4. **ç¯å¢ƒå˜é‡æœªé…ç½®**: æ£€æŸ¥.envæ–‡ä»¶é…ç½®

### æ—¥å¿—æŸ¥çœ‹
```bash
# åº”ç”¨æ—¥å¿—
./deploy.sh logs --prod

# Dockerç³»ç»Ÿæ—¥å¿—
docker system events

# å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect orderbot-prod
```

## å‡çº§å’Œç»´æŠ¤

### åº”ç”¨æ›´æ–°
```bash
# åœæ­¢æœåŠ¡
./deploy.sh stop --prod

# é‡æ–°æ„å»º
./deploy.sh build

# å¯åŠ¨æœåŠ¡
./deploy.sh start --prod
```

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®ç›®å½•
tar -czf backup-$(date +%Y%m%d).tar.gz data/ images/ logs/

# æ¢å¤æ•°æ®
tar -xzf backup-YYYYMMDD.tar.gz
```

---

**éƒ¨ç½²å®Œæˆï¼** ğŸ‰

ç°åœ¨ä½ çš„Telegramè®¢å•ç®¡ç†æœºå™¨äººå·²ç»æˆåŠŸéƒ¨ç½²åˆ°Dockerç¯å¢ƒä¸­ï¼Œå…·å¤‡äº†å®Œæ•´çš„ç”Ÿäº§çº§ç‰¹æ€§å’Œç›‘æ§èƒ½åŠ›ã€‚